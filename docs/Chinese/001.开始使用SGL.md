## SGL (Small Graphics Library)

### 注册底层绘图接口（必须）
和大多数GUI库一样，在使用SGL库之前，请注册底层的绘图接口，底层接口的注册如下：
```c

void panel_flush_area(int16_t x, int16_t y, int16_t w, int16_t h, sgl_color_t *src)
{
    tft_set_win(x, y, x + w - 1, y + h - 1);
	GPIO_WriteBit(SPI_DC_PORT, SPI_DC_PIN, 1);
	SPI1_WriteMultByte((uint8_t*)src, w * h * 2);
}

...
sgl_device_fb_t fb_dev = {
    .xres = CONFIG_SGL_PANEL_WIDTH,
    .yres = CONFIG_SGL_PANEL_HEIGHT,
    .xres_virtual = CONFIG_SGL_PANEL_WIDTH,
    .yres_virtual = CONFIG_SGL_PANEL_HEIGHT,
    .flush_area = panel_flush_area,
    .framebuffer = panel_buffer,
    .framebuffer_size = sizeof(panel_buffer), //如果只想使用一行帧缓冲，则将此值设置为一行的帧缓冲大小，即：CONFIG_SGL_PANEL_WIDTH * 2
};

sgl_device_fb_register(&fb_dev);
...
```
上面的过程中定义了一个`sgl_device_fb_t`结构体，并且初始化了一些主要的参数，参数的含义如下：
- `xres`: 屏幕的宽度
- `yres`: 屏幕的高度
- `xres_virtual`: 屏幕的虚拟宽度
- `yres_virtual`: 屏幕的虚拟高度
- `flush_area`：刷新区域函数，用于刷新指定区域
- `framebuffer`：帧缓冲区指针，指向帧缓冲区地址处
- `framebuffer_size`：帧缓冲区大小

`sgl_device_fb_register`函数用于注册帧缓冲区设备，参数为`sgl_device_fb_t`结构体指针。

### 注册调试接口（可选）
使用`void sgl_device_log_register(void (*log_puts)(const char *str))`函数来注册调试接口， 参数为一个指向`log_puts`函数的指针，例如下面的代码：
```c
void uart_put_string(const char *str) {
   /* 发送串口数据 */
}

...
sgl_device_log_register(uart_put_string);
...

```

### 调用sgl_init()函数
首先需要先包含`sgl.h`头文件，然后调用`sgl_init()`函数用于初始化`SGL`库，其中包括内存初始化，`SGL`数据结构初始化等，然后即可开始创建控件和绘制图形了，例如下面的代码：
```c
#include <sgl.h>

int main(void)
{
    sgl_device_fb_register(&fb_dev);
    sgl_device_log_register(uart_put_string);
    sgl_init();

    /* 创建控件 */

    while(1) {
        sgl_task_handle();
    };

    return 0;
}
```

### 注册鼠标事件(或者触摸点击事件)
在鼠标点击事件或者触摸点击事件的中断服务函数中调用`sgl_event_send_pos()`函数，这个函数会处理鼠标点击事件或者触摸点击事件，参数为鼠标点击事件坐标和触摸点击事件的类型，例如下面的代码：
```c
/* 包含头文件 */
#include <sgl.h>
...
static void mouse_event_interrupt(xxxxx) 
{
    sgl_event_t evt;

    if(判断按下) {
        evt.pos.x = event->motion.x;
        evt.pos.y = event->motion.y;
        evt.type = SGL_EVENT_PRESSED;
        sgl_event_send_pos(evt.pos, evt.type);
    }
    else if(判断释放) {
        evt.pos.x = event->motion.x;
        evt.pos.y = event->motion.y;
        evt.type = SGL_EVENT_RELEASED;
        sgl_event_send_pos(evt.pos, evt.type);
    }
}
```


### 创建控件
如用如下代码来创建一个控件：
```c
sgl_obj_t *button = sgl_button_create(NULL);
sgl_obj_set_pos(button, 100, 300);
sgl_obj_set_size(button, 200, 100);
sgl_obj_set_font(button, &song23);
sgl_obj_set_radius(button, 60);
sgl_obj_set_border_width(button, 0);
sgl_obj_set_style(button, SGL_STYLE_TEXT_COLOR, 0x5de);
sgl_obj_set_style(button, SGL_STYLE_TEXT ,SGL_TEXT("Click me!"));
```
